{% block css %}
     <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <meta name="description" content=""/>
  <meta name="author" content=""/>
  <title>Dashtreme Admin - Free Dashboard for Bootstrap 4 by Codervent</title>
  <!-- loader-->
  <link href="assets/back/css/pace.min.css" rel="stylesheet"/>
  <script src="assets/back/js/pace.min.js"></script>
  <!--favicon-->
  <link rel="icon" href="assets/back/images/favicon.ico" type="image/x-icon">
  <!-- simplebar CSS-->
  <link href="assets/back/plugins/simplebar/css/simplebar.css" rel="stylesheet"/>
  <!-- Bootstrap core CSS-->
  <link href="assets/back/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- animate CSS-->
  <link href="assets/back/css/animate.css" rel="stylesheet" type="text/css"/>
  <!-- Icons CSS-->
  <link href="assets/back/css/icons.css" rel="stylesheet" type="text/css"/>
  <!-- Sidebar CSS-->
  <link href="assets/back/css/sidebar-menu.css" rel="stylesheet"/>
  <!-- Custom Style-->
  <link href="assets/back/css/app-style.css" rel="stylesheet"/>
  <style>
  /* Dark Theme Inputs */
    .cool-input {
        background: rgba(30, 30, 30, 0.9); /* Dark glassy effect */
        color: rgb(223, 223, 223); /* White text */
        border: 1px solid rgba(102, 51, 5, 0.45);
        border-radius: 8px;
        padding: 8px 12px;
        width: 100%;
        font-size: 14px;
        transition: all 0.3s ease-in-out;
    }

    /* On focus, make inputs glow */
    .cool-input:focus {
        border: 1px solid rgb(108, 45, 0); /* Yellow glow */
        box-shadow: 0 0 10px rgba(143, 63, 3, 0.59);
        outline: none;
    }

    /* Dark Cards */
    .card {
        background: rgb(40, 40, 40); /* Darker background */
        border-radius: 12px;
        padding: 16px;
        color: white;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
    }

    /* Labels */
    .card-body label {
        font-size: 14px;
        font-weight: 600;
        color: rgba(194, 113, 73, 0.86); /* Soft yellow text */
    }

    /* List Group Items */
    .list-group-item {
        background: rgba(50, 50, 50, 0.9);
        border: 1px solid rgba(102, 51, 5, 0.45);
        color: white;
    }

</style>
  
{% endblock %}


{% block body %}


<body class="bg-theme bg-theme77">

<!-- start loader -->
   <div id="pageloader-overlay" class="visible incoming"><div class="loader-wrapper-outer"><div class="loader-wrapper-inner" ><div class="loader"></div></div></div></div>
   <!-- end loader -->

<!-- Start wrapper-->
 <div id="wrapper">

  <!--Start sidebar-wrapper-->
   <div id="sidebar-wrapper" data-simplebar="" data-simplebar-auto-hide="true">
     <div class="brand-logo">
      <a href="index.html">
       <img src="assets/back/images/logo-icon.png" class="logo-icon" alt="logo icon">
       <h5 class="logo-text">Dashtreme Admin</h5>
     </a>
   </div>
   <ul class="sidebar-menu do-nicescrol">
      <li class="sidebar-header">MAIN NAVIGATION</li>
      <li>
        <a href="back">
          <i class="zmdi zmdi-view-dashboard"></i> <span>Dashboard</span>
        </a>
      </li>

      <li>
        <a href="matchingBack">
          <i class="zmdi zmdi-invert-colors"></i> <span>matchings</span>
        </a>
      </li>

      <li>
        <a href="forumback">
          <i class="zmdi zmdi-format-list-bulleted"></i> <span>Forum</span>
        </a>
      </li>

      <li>
        <a href="produitBack">
          <i class="zmdi zmdi-grid"></i> <span>Produits</span>
        </a>
      </li>

      <li>
        <a href="commandeBack">
          <i class="zmdi zmdi-face"></i> <span>Commandes</span>
        </a>
      </li>



      <li>
        <a href="reservationBack">
          <i class="zmdi zmdi-calendar-check"></i> <span>Reservation</span>
          <small class="badge float-right badge-light">New</small>
        </a>
      </li>


      <li>
        <a href="evenementBack">
          <i class="zmdi zmdi-face"></i> <span>Evenement</span>
        </a>
      </li>

      <li>
        <a href="loginback" target="_blank">
          <i class="zmdi zmdi-lock"></i> <span>Login</span>
        </a>
      </li>

	
      <li class="sidebar-header">LABELS</li>
      <li><a href="javaScript:void();"><i class="zmdi zmdi-coffee text-danger"></i> <span>Important</span></a></li>
      <li><a href="javaScript:void();"><i class="zmdi zmdi-chart-donut text-success"></i> <span>Warning</span></a></li>
      <li><a href="javaScript:void();"><i class="zmdi zmdi-share text-info"></i> <span>Information</span></a></li>

    </ul>
   
   </div>
   <!--End sidebar-wrapper-->

<!--Start topbar header-->
<header class="topbar-nav">
 <nav class="navbar navbar-expand fixed-top">
  <ul class="navbar-nav mr-auto align-items-center">
    <li class="nav-item">
      <a class="nav-link toggle-menu" href="javascript:void();">
       <i class="icon-menu menu-icon"></i>
     </a>
    </li>
    <li class="nav-item">
      <form class="search-bar">
        <input type="text" class="form-control" placeholder="Enter keywords">
         <a href="javascript:void();"><i class="icon-magnifier"></i></a>
      </form>
    </li>
  </ul>
     
  <ul class="navbar-nav align-items-center right-nav-link">
    <li class="nav-item dropdown-lg">
      <a class="nav-link dropdown-toggle dropdown-toggle-nocaret waves-effect" data-toggle="dropdown" href="javascript:void();">
      <i class="fa fa-envelope-open-o"></i></a>
    </li>
    <li class="nav-item dropdown-lg">
      <a class="nav-link dropdown-toggle dropdown-toggle-nocaret waves-effect" data-toggle="dropdown" href="javascript:void();">
      <i class="fa fa-bell-o"></i></a>
    </li>
    <li class="nav-item language">
      <a class="nav-link dropdown-toggle dropdown-toggle-nocaret waves-effect" data-toggle="dropdown" href="javascript:void();"><i class="fa fa-flag"></i></a>
      <ul class="dropdown-menu dropdown-menu-right">
          <li class="dropdown-item"> <i class="flag-icon flag-icon-gb mr-2"></i> English</li>
          <li class="dropdown-item"> <i class="flag-icon flag-icon-fr mr-2"></i> French</li>
          <li class="dropdown-item"> <i class="flag-icon flag-icon-cn mr-2"></i> Chinese</li>
          <li class="dropdown-item"> <i class="flag-icon flag-icon-de mr-2"></i> German</li>
        </ul>
    </li>
    <li class="nav-item">
      <a class="nav-link dropdown-toggle dropdown-toggle-nocaret" data-toggle="dropdown" href="#">
        <span class="user-profile"><img src="https://via.placeholder.com/110x110" class="img-circle" alt="user avatar"></span>
      </a>
      <ul class="dropdown-menu dropdown-menu-right">
       <li class="dropdown-item user-details">
        <a href="javaScript:void();">
           <div class="media">
             <div class="avatar"><img class="align-self-start mr-3" src="https://via.placeholder.com/110x110" alt="user avatar"></div>
            <div class="media-body">
            <h6 class="mt-2 user-title">Sarajhon Mccoy</h6>
            <p class="user-subtitle">mccoy@example.com</p>
            </div>
           </div>
          </a>
        </li>
        <li class="dropdown-divider"></li>
        <li class="dropdown-item"><i class="icon-envelope mr-2"></i> Inbox</li>
        <li class="dropdown-divider"></li>
        <li class="dropdown-item"><i class="icon-wallet mr-2"></i> Account</li>
        <li class="dropdown-divider"></li>
        <li class="dropdown-item"><i class="icon-settings mr-2"></i> Setting</li>
        <li class="dropdown-divider"></li>
        <li class="dropdown-item"><i class="icon-power mr-2"></i> Logout</li>
      </ul>
    </li>
  </ul>
</nav>
</header>
<!--End topbar header-->

<div class="clearfix"></div>
	
  <div class="content-wrapper">
    <div class="container-fluid">

   <div class="container mt-4 col-sm-12 text-center ftco-animate">
    <h4 class="text-center mb-4 text-light">Matching Details</h4>
    <div class="row">
        {% for matching in matchings %}
            {% if editAssessorsForms is defined and editAssessorsForms[matching.getId()] is defined %}
                {% set editAssessorsForm = editAssessorsForms[matching.getId()] %}
            {% endif %}

            <!-- Matching Details Card -->
            <div class="col-md-6">
                <div class="card mb-4 p-3 shadow-lg bg-dark border-light">
                    <div class="card-body text-white">
                        <div class="row">
                            <!-- Subject & ID -->
                            <div class="col-6 mt-2">
                                <label><strong>Subject:</strong></label>
                                <input type="text" class="cool-input" value="{{ matching.getSujetRencontre() }}" readonly>
                            </div>
                            <div class="col-6 mt-2">
                                <label><strong>ID:</strong></label>
                                <input type="text" class="cool-input" value="{{ matching.getId() }}" readonly>
                            </div>

                            <!-- Tab Number & Number of People -->
                            <div class="col-6 mt-2">
                                <label><strong>Tab Number:</strong></label>
                                <input type="text" class="cool-input" value="{{ matching.getNumTable() }}" readonly>
                            </div>
                            <div class="col-6 mt-2">
                                <label><strong>Num People:</strong></label>
                                <input type="text" class="cool-input" value="{{ matching.getNbrPersonneMatchy() }}" readonly>
                            </div>

                            <!-- Rating -->
                            <div class="col-6 mt-2">
                                <label><strong>name of matching:</strong></label>
                                <input type="text" class="cool-input" value="{{ matching.getName()|default('-') }}" readonly>
                            </div>

                            <!-- Actions -->
                            <div class="col-6 mt-2">
                                <label><strong>Actions:</strong></label><br>
                                <button type="button" class="btn btn-warning btn-sm" data-toggle="modal">
                                    no Actions 
                                </button>
                                <form method="post" action="{{ path('matching_delete', {'id': matching.getId()}) }}" style="display:inline-block;">
                                    <input type="hidden" name="_token">
                                    <button class="btn btn-danger btn-sm">available for now</button>
                                </form>
                            </div>

                            <!-- Feedback Section -->
                            <div class="col-12 mt-2">
                                <label><strong>Feedback:</strong></label>
                                <textarea class="cool-input" rows="3" readonly>{{ matching.getFeedback()|default('No feedback') }}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Assessors Card -->
            <div class="col-md-6">
                <div class="card mb-4 p-3 shadow-lg bg-dark border-light">
                    <div class="card-body text-white">
                        <div class="row">
                            <!-- Assessors List -->
                            <div class="col-12 mt-2">
                                <label><strong>Assessors with Access:</strong></label>
                                <ul class="list-group">
                                    {% for assessor in matching.assessors %}
                                        <li class="list-group-item bg-secondary text-white">
                                            {{ assessor.getNomUser() }} 
                                        </li>
                                    {% else %}
                                        <li class="list-group-item bg-secondary text-white">No assessors assigned with access</li>
                                    {% endfor %}
                                </ul>
                            </div>

                            <!-- Actions for Assessors -->
                            <div class="col-12 mt-3">
                                <label><strong>Actions:</strong></label><br>
                                <button type="button" class="btn btn-warning btn-sm" data-toggle="modal" data-target="#editAssessorsModal{{ matching.getId() }}">
                                    no Actions available for now
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit Assessors Modal -->
 
            
        {% else %}
            <div class="col-12 text-center text-light">
                <p class="text-muted">No matchings found</p>
            </div>
        {% endfor %}
    </div>
</div>



                </div>
            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
    </div>
    <!-- container -->
</div>

          </div>
        </div>
      </div>
    </section>

<!-- Create matching Modal -->
<div class="modal fade" id="creatematchingModal" tabindex="-1" role="dialog" aria-labelledby="creatematchingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="background-color: black; color: white;">
            <div class="modal-header">
                <h5 class="modal-title" id="creatematchingModalLabel">Create matching</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body col-sm-12 text-center ftco-animate">
                <div class="book p-4">
                    {{ form_start(form) }}
                    <div class="form-group">
                        {{ form_label(form.numTable) }}
                        {{ form_widget(form.numTable, {'attr': {'class': 'form-control', 'style': 'background-color: #333; color: white;'}}) }}
                    </div>
                    <div class="form-group">
                        {# Changed field name from sujet_matching to sujetRencontre #}
                        {{ form_label(form.sujetRencontre) }}
                        {{ form_widget(form.sujetRencontre, {'attr': {'class': 'form-control', 'style': 'background-color: black; color: white;'}}) }}
                    </div>
                    <div class="form-group">
                        {{ form_label(form.nbrPersonneMatchy) }}
                        {{ form_widget(form.nbrPersonneMatchy, {'attr': {'class': 'form-control', 'style': 'background-color: #333; color: white;'}}) }}
                    </div>
                    <button class="btn btn-primary">Save</button>
                    {{ form_end(form) }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Show and Edit Modals for each matching -->
{% for matching in matchings %}
    <!-- Show matching Modal -->
    <div class="modal fade" id="showmatchingModal{{ matching.getId() }}" tabindex="-1" role="dialog" aria-labelledby="showmatchingModalLabel{{ matching.getId() }}" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content" style="background-color: black; color: white;">
                <div class="modal-header">
                    <h5 class="modal-title" id="showmatchingModalLabel{{ matching.getId() }}">Show matching</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="book p-4">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th>Id</th>
                                    <td>{{ matching.getId() }}</td>
                                </tr>
                                <tr>
                                    <th>Table Number</th>
                                    <td>{{ matching.getNumTable() }}</td>
                                </tr>
                                <tr>
                                    <th>Sujet matching</th>
                                    <td>{{ matching.getSujetRencontre() }}</td>
                                </tr>
                                <tr>
                                    <th>Number of People</th>
                                    <td>{{ matching.getNbrPersonneMatchy() }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="modal fade" id="editAssessorsModal{{ matching.getId() }}" tabindex="-1" role="dialog" aria-labelledby="editAssessorsModalLabel{{ matching.getId() }}" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
         <div class="modal-content" style="background-color: black; color: white;">
            <div class="modal-header">
                <h5 class="modal-title" id="editAssessorsModalLabel{{ matching.getId() }}">Edit Assessors</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                {% if editAssessorsForm is defined %}
                    {{ form_start(editAssessorsForm, {'action': path('matching_edit_assessors', {'id': matching.getId()}), 'method': 'POST'}) }}
                    <div class="form-group">
                        {{ form_label(editAssessorsForm.assessors) }}
                        {{ form_widget(editAssessorsForm.assessors, {'attr': {'class': 'form-control bg-secondary text-white'}}) }}
                    </div>
                    <button class="btn btn-primary">Save</button>
                    {{ form_end(editAssessorsForm) }}
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endfor %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.edit-matching-form').forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(form);
            fetch(form.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload(); // Reload the page on success
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => console.error('Error:', error));
        });
    });
});
</script>



        </div>
      </div>
    </div>
  </div><!--End Row-->

  <!--start overlay-->
		  <div class="overlay toggle-menu"></div>
		<!--end overlay-->
  
    </div>
    <!-- End container-fluid-->
    
    </div><!--End content-wrapper-->
   <!--Start Back To Top Button-->
    <a href="javaScript:void();" class="back-to-top"><i class="fa fa-angle-double-up"></i> </a>
    <!--End Back To Top Button-->
	

	
	<!--start color switcher-->

  <!--end color switcher-->
   
  </div><!--End wrapper-->
{% endblock  %}

{% block js %}
  <!-- Bootstrap core JavaScript-->
  <script src="assets/back/js/jquery.min.js"></script>
  <script src="assets/back/js/popper.min.js"></script>
  <script src="assets/back/js/bootstrap.min.js"></script>
  
  <!-- simplebar js -->
  <script src="assets/back/plugins/simplebar/js/simplebar.js"></script>
  <!-- sidebar-menu js -->
  <script src="assets/back/js/sidebar-menu.js"></script>
  
  <!-- Custom scripts -->
  <script src="assets/back/js/app-script.js"></script>
{% endblock js %}
